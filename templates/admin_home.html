<!DOCTYPE html>
<html lang="en" data-theme="cupcake">
<head>
  <meta charset="UTF-8" />
  <title>Admin Dashboard - Eastern Province Cement Co.</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 text-gray-800 min-h-screen flex flex-col">

  {% include 'header.html' %}

  <main class="flex-grow container mx-auto px-6 py-10 max-w-7xl">
    <h1 class="text-3xl font-bold text-center text-[#0a1f44] mb-6">Welcome, {{ user.username }}</h1>

    <!-- Upload Guide Button -->
    <div class="flex justify-center mb-10">
      <a href="{{ url_for('course_guide_upload') }}"
         class="inline-block bg-[#0a1f44] hover:bg-[#122d65] text-white font-semibold py-3 px-8 rounded-lg shadow-md transition-colors duration-300">
        Upload New Guide
      </a>
    </div>

    <!-- Quick Stats -->
    <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-10">
      <div class="bg-white shadow rounded-lg p-6 text-center border border-gray-300">
        <p class="text-lg font-semibold mb-2">Total Trainees</p>
        <p class="text-3xl text-[#0a1f44] font-bold">{{ total_trainees }}</p>
      </div>
      <div class="bg-white shadow rounded-lg p-6 text-center border border-gray-300">
        <p class="text-lg font-semibold mb-2">Trainees Without Reports</p>
        <p class="text-3xl text-red-600 font-bold">{{ trainees_with_no_reports }}</p>
      </div>
      <div class="bg-white shadow rounded-lg p-6 text-center border border-gray-300">
        <p class="text-lg font-semibold mb-2">Reports Submitted Today</p>
        <p class="text-3xl text-green-600 font-bold">{{ reports_today }}</p>
      </div>
    </div>

    <!-- Trainee Table -->
    <section class="bg-white shadow rounded-lg p-6 overflow-x-auto mb-10 border border-gray-300">
      <h2 class="text-2xl font-semibold mb-6 text-[#0a1f44]">Trainees in Your Department</h2>
      <table class="w-full table-auto border-collapse text-left">
        <thead>
          <tr class="bg-gray-200 text-gray-700">
            <th class="px-4 py-3 border">#</th>
            <th class="px-4 py-3 border">Username</th>
            <th class="px-4 py-3 border">Department</th>
            <th class="px-4 py-3 border">University</th>
            <th class="px-4 py-3 border">Created At</th>
          </tr>
        </thead>
        <tbody>
          {% for trainee in trainees %}
          <tr class="hover:bg-gray-50">
            <td class="border px-4 py-2">{{ loop.index }}</td>
            <td class="border px-4 py-2 font-medium">{{ trainee.username }}</td>
            <td class="border px-4 py-2">{{ trainee.department.name if trainee.department else '—' }}</td>
            <td class="border px-4 py-2">{{ trainee.university or '—' }}</td>
            <td class="border px-4 py-2">{{ trainee.created_at.strftime('%Y-%m-%d') if trainee.created_at else '—' }}</td>
          </tr>
          {% else %}
          <tr>
            <td colspan="5" class="border px-4 py-4 text-center text-gray-500">No trainees found.</td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </section>

    <!-- Reports Table -->
    <section class="bg-white shadow rounded-lg p-6 overflow-x-auto border border-gray-300">
      <h2 class="text-2xl font-semibold mb-6 text-[#0a1f44]">Reports Submitted by Trainees</h2>
      <table class="w-full table-auto border-collapse text-left">
        <thead>
          <tr class="bg-gray-200 text-gray-700">
            <th class="px-4 py-3 border">#</th>
            <th class="px-4 py-3 border">Report Title</th>
            <th class="px-4 py-3 border">Trainee Username</th>
            <th class="px-4 py-3 border">Submitted At</th>
            <th class="px-4 py-3 border text-center">Download</th>
          </tr>
        </thead>
        <tbody>
          {% for report in reports %}
          <tr class="hover:bg-gray-50">
            <td class="border px-4 py-2">{{ loop.index }}</td>
            <td class="border px-4 py-2 font-medium">{{ report.title }}</td>
            <td class="border px-4 py-2">{{ report.trainee.username }}</td>
            <td class="border px-4 py-2">{{ report.created_at.strftime('%Y-%m-%d %H:%M') }}</td>
            <td class="border px-4 py-2 text-center">
              <a href="{{ url_for('download_report', report_id=report.id) }}"
                 class="text-blue-600 hover:underline font-semibold">Download</a>
            </td>
          </tr>
          {% else %}
          <tr>
            <td colspan="5" class="border px-4 py-4 text-center text-gray-500">No reports submitted yet.</td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </section>

  </main>

  {% include 'footer.html' %}
</body>
</html>
